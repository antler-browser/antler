// Auto-generated by scripts/minify-webview-js.js
// DO NOT EDIT - Run 'yarn minify-webview' to regenerate

export const minifiedMainTemplate = "var p=(y,c,s)=>new Promise((g,w)=>{var f=t=>{try{r(s.next(t))}catch(n){w(n)}},e=t=>{try{r(s.throw(t))}catch(n){w(n)}},r=t=>t.done?g(t.value):Promise.resolve(t.value).then(f,e);r((s=s.apply(y,c)).next())});(function(){var y=\"__WEBVIEW_PUBLIC_KEY__\";function c(e){for(var r=atob(e),t=new Uint8Array(r.length),n=0;n<r.length;n++)t[n]=r.charCodeAt(n);return t}function s(e){var r=Object.keys(e).sort();return JSON.stringify(e,r)}function g(){if(crypto.randomUUID)return crypto.randomUUID();var e=new Uint8Array(16);return crypto.getRandomValues(e),Array.from(e,function(r){return(\"0\"+r.toString(16)).slice(-2)}).join(\"\")}function w(e){return p(this,null,function*(){if(typeof crypto==\"undefined\"||!crypto.subtle)return console.error(\"[IRL Browser] crypto.subtle not available - cannot verify signatures\"),!1;if(!e.signature)return console.error(\"[IRL Browser] Response missing signature - possible forgery attempt\"),!1;try{var r=e.signature,t={type:e.type,requestId:e.requestId,timestamp:e.timestamp};e.jwt!==void 0&&(t.jwt=e.jwt),e.result!==void 0&&(t.result=e.result);var n=s(t),l=new TextEncoder().encode(n),i=c(r),u=c(y),v=yield crypto.subtle.importKey(\"raw\",u,{name:\"ECDSA\",namedCurve:\"P-256\"},!1,[\"verify\"]),o=yield crypto.subtle.verify({name:\"ECDSA\",hash:\"SHA-256\"},v,i,l);return o||console.error(\"[IRL Browser] Signature verification failed - possible XSS forgery attempt\"),o}catch(d){return console.error(\"[IRL Browser] Error verifying signature:\",d),!1}})}function f(e,r,t){return new Promise(function(n,l){var i=!1,u,v=g();function o(I){return p(this,null,function*(){if(I.data){var a=I.data;if(typeof a==\"string\")try{a=JSON.parse(a)}catch(b){return}if(a.requestId===v){if(!(yield w(a))){i||(i=!0,clearTimeout(u),window.removeEventListener(\"message\",o),l(new Error(\"Invalid signature - possible XSS forgery attempt\")));return}a.type===e+\":response\"?i||(i=!0,clearTimeout(u),window.removeEventListener(\"message\",o),n(a.jwt||a.result)):a.type===e+\":error\"&&(i||(i=!0,clearTimeout(u),window.removeEventListener(\"message\",o),l(new Error(a.error||\"Request failed\"))))}}})}window.addEventListener(\"message\",o);var d={type:e,requestId:v};for(var m in r)r.hasOwnProperty(m)&&(d[m]=r[m]);window.ReactNativeWebView.postMessage(JSON.stringify(d),\"*\"),u=setTimeout(function(){i||(i=!0,window.removeEventListener(\"message\",o),l(new Error(\"Request timed out\")))},t||5e3)})}window.irlBrowser||Object.defineProperty(window,\"irlBrowser\",{value:Object.freeze({getProfileDetails:function(){return f(\"irl:api:getProfileDetails\",{})},getAvatar:function(){return f(\"irl:api:getAvatar\",{})},getBrowserDetails:function(){return __BROWSER_INFO__},requestPermission:function(e){return f(\"irl:api:requestPermission\",{permission:e})},close:function(){window.ReactNativeWebView.postMessage(JSON.stringify({type:\"irl:api:close\"}),\"*\")}}),writable:!1,configurable:!1,enumerable:!0}),console.log(\"[IRL Browser] WebView API injected\")})();\n";
